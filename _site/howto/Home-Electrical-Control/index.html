<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML
><HEAD
><TITLE
>Home Electrical Device Control HOWTO</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><link rel="stylesheet" href="../bookstyle.css"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
></A
>Home Electrical Device Control HOWTO</H1
><H3
CLASS="AUTHOR"
><A
NAME="AEN4"
>Rui Li</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
><TT
CLASS="EMAIL"
>&#60;<A
HREF="mailto:ruili@worldnet.att.net"
>ruili@worldnet.att.net</A
>&#62;</TT
></P
></DIV
></DIV
><P
CLASS="OTHERCREDIT"
><B
>Joy Yokley - </B
><SPAN
CLASS="CONTRIB"
>Coverted document from Linuxdoc to DocBook v4.1 (SGML).</SPAN
></P
><P
CLASS="PUBDATE"
>2003-02-08<BR></P
><DIV
CLASS="REVHISTORY"
><TABLE
WIDTH="100%"
BORDER="0"
><TR
><TH
ALIGN="LEFT"
VALIGN="TOP"
COLSPAN="3"
><B
>Revision History</B
></TH
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 0.008</TD
><TD
ALIGN="LEFT"
>2003-02-08</TD
><TD
ALIGN="LEFT"
>Revised by: Goldencat</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 0.007</TD
><TD
ALIGN="LEFT"
>2002-02-12</TD
><TD
ALIGN="LEFT"
>Revised by: RL</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 0.006</TD
><TD
ALIGN="LEFT"
>2001-06-27</TD
><TD
ALIGN="LEFT"
>Revised by: JEY</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 0.005</TD
><TD
ALIGN="LEFT"
>2001-06-13</TD
><TD
ALIGN="LEFT"
>Revised by: RL</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 0.004</TD
><TD
ALIGN="LEFT"
>2001-06-12</TD
><TD
ALIGN="LEFT"
>Revised by: JEY</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
></TABLE
></DIV
><DIV
><DIV
CLASS="ABSTRACT"
><A
NAME="AEN10"
></A
><P
></P
><P
>This HOWTO will tell you how to use Linux to control your home electrical
					devices. You will only need to make a very
					simple circuit to control almost any kind of electrical
					device using Linux!</P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>1. <A
HREF="#INTRODUCTION"
>Introduction</A
></DT
><DT
>2. <A
HREF="#SYSREQUIREMENTS"
>System Requirement</A
></DT
><DT
>3. <A
HREF="#CIRCUIT"
>Electronic Circuit</A
></DT
><DT
>4. <A
HREF="#RELAY"
>Examples of Relays</A
></DT
><DT
>5. <A
HREF="#THANKS"
>Special Thanks</A
></DT
><DT
>6. <A
HREF="#COPYRIGHT"
>Copyright and License</A
></DT
></DL
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="INTRODUCTION"
></A
>1. Introduction</H1
><P
>Many people asked me, "Is it possible to control some electrical
			stuff [e.g. lights, radio, tv, etc.] by using a home computer?" The answer is YES. 
			The process is very easy, and anyone can do it.</P
><P
>After I read the Coffee Machine Mini-HOWTO, I got an idea of how to control 
			my home electrical appliances. I made some modifications on the circuit discussed in that 
			Coffee Machine Mini-HOWTO, and wrote a simple program. The circuit can 
			control many small electrical devices.^_^ You can use <B
CLASS="COMMAND"
>crontab</B
>
			to set your lights to come on automatically or to turn on your airconditioner.  I use it to control my VCR and VCD ( I do still need some modification on VCR/VCD).
			By writing a simple program, you can control everything over the web. You can use 
			telnet with SSH and your telephone dial in to control all the appliances you have on the circuit.</P
><P
>This circuit is VERY SIMPLE. Even if you don't know anything
			about circuits, you can set up this circuit.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="SYSREQUIREMENTS"
></A
>2. System Requirement</H1
><P
>Get any computer that is running Linux and has a working parallel port. :)
			I'm using a 386DX with 4MB RAM 40MB HD.
			You will need gcc to compile the program. If you want to use telnet or SSH,
			you will also need <SPAN
CLASS="APPLICATION"
>telnetd</SPAN
> or <SPAN
CLASS="APPLICATION"
>sshd</SPAN
>. You can write your own 
			program by using <SPAN
CLASS="APPLICATION"
>ioperm</SPAN
> and <SPAN
CLASS="APPLICATION"
>outb</SPAN
>. If you would like to 
			use my program, you will need g++.</P
><P
>Click the following link to download my program. You will need g++ to compile it.
			<A
HREF="http://edc.sourceforge.net/paralle.tar.gz"
TARGET="_top"
> edc.sourceforge.net/paralle.tar.gz</A
>.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="CIRCUIT"
></A
>3. Electronic Circuit</H1
><P
>The data line of the parallel port can provide between 0 and 5 volts.
			Therefore, we can use this line to control a relay and let that relay control
			an electrical device.</P
><P
>Use pins 2 through 9 to get +5V</P
><P
>Use pins 18 through 25 as the Ground</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>&#13;            ____________________________________________________________
           /                                                            \
           \     13  12  11  10   9   8   7   6   5   4   3   2   1     /
            \                                                          /
             \     25  24  23  22  21  20  19  18  17  16  15  14     /
              \______________________________________________________/




                                             | Vcc for Relay
                                             |
                                             |
                                    / -------+--------| |---------|
P data              4.7K         B /  c      | 1N4002 |_|         |-------
-----------/\/\/\/\---------+-----| NPN    _____        | relay   |home device
                            |     \   e     /_\       |-|         |-------
                 LED        X      \         +--------| |---------|
P Ground                    |       |        |
----------------------------+-------+--------+
Relay Ground                                 |
---------------------------------------------+

	</PRE
></FONT
></TD
></TR
></TABLE
><P
>Below is the key to the diagram above:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>P data		parallel port data line(pin 2 to pin 9, use any)

P Ground			parallel port ground (pin 18 to pin 25, use any)

Vcc				depends on the type of your relay. I'm using 12VDC

Relay Ground	the ground for 12VDC

4.7k				4.7K resistor

NPN				C2235 NPN transistor

1N4002			1N4002 diode

LED				light emitting diode

relay				a coil relay</PRE
></FONT
></TD
></TR
></TABLE
><P
>+5 volts from parallel port will turn on the relay. Once the relay is on,
			the device connected to that relay will be on. When the parallel port's data
			line goes back to 0, it will turn off the relay, and device is off.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="RELAY"
></A
>4. Examples of Relays</H1
><P
>The diagrams below are used to explain how relays work.</P
><P
>The relay itself is just a switch as seen in the diagram below:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>relay power off                        relay power on

       |3                                    |3
       |                                     |
       |                                     |
       o                                     o
        \                                    |
       o \                                   o
       |                                     |
       |                                     |
       |                                     |
       |4                                    |4&#13;</PRE
></FONT
></TD
></TR
></TABLE
><P
>The diagram below demonstrates the setup of a 4 pin relay.</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>&#13;      ____________________________
      |                          |
  1   |                          |  3
 -----|---------s     o----------|-------
      |  coil   s      \switch   |
  2   |         s       \        |  4
 -----|---------s     o- \-------|-------
      |                          |
      |                          |
      |                          |
      |__________________________|&#13;</PRE
></FONT
></TD
></TR
></TABLE
><P
>			In the diagram above, pin 3 and pin 4 are disconnected by default.
			When you send +12V between pin 1 and pin 2,
			it will turn on a switch, and pin 3 and 4 are now connected.
		</P
><P
>The following is a  5 pin relay:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>&#13;           _______________________________
           |                             |
     1     |                             |       5
  ---------|---+            o------------|----------------
           |   |-----------/---- s       |
           |              /      s       |
     3     |             /       s       |
  ---------|-----------o/   coil s       |       4
           |                 o---s-------|----------------
           |                     |       |
           |                     |       |
     2     |                     |       |
 ----------|---------------------+       |
           |_____________________________|</PRE
></FONT
></TD
></TR
></TABLE
><P
>				In the above diagram pin 3 is connected to pin 5, by default.
				By sending +12V between pin 1 and pin 2, you will
				will turn on a switch. Pin 1 and pin 2 will disconnect,
				and pin 5 and pin 4 will connect.
				</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
> relay power off                 relay power on

     |5                                  |5
     |                                   |
     |                                   |
     o                                   o
      \                                  |
     o \                                 o  o
     |  o                                |  |
     |  |                                |  |
     |  |                                |  |
    4|  |3                              4|  |3</PRE
></FONT
></TD
></TR
></TABLE
><P
>Some relays may have more that 5 pins. More pins just means there are more switches.</P
><P
>I wrote a simple program that can control 8 relays. The program is available at the following location and 
				will need g++ in order to be able to use this program.
				<A
HREF="http://edc.sourceforge.net/paralle.tar.gz"
TARGET="_top"
>http://edc.sourceforge.net/paralle.tar.gz</A
></P
><P
>A complete circuit can control up to eight relays, that means that a complete circuit can control
				eight different devices. You will need a DB25 connector. Using a parallel
				switch cable, connect this relay board to your computer. I put the relay board in a box 
				and use a parallel switch cable to connect it to my Linux box:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>Panel: LED, Switch		Back:  DB25 connector</PRE
></FONT
></TD
></TR
></TABLE
><P
>Below is an example of how a relay board would connect with your electrical device:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="PROGRAMLISTING"
>			CONNECTED RELAY BOARD
			

                         +-----+ power outlet
       1 _______3        |   __|________             ||   ||
       --|     |---------+  |  |       |             ||   ||
       2 |relay|4           | (o) (o)  |            _||___||__
       --|_____|----+       |------|---|            |        |
                    |              |                |        | 
                    | +------------+                |        | plug
            ground  | | hot                         |        |
                    | |                             |        |
                  __|_|__                           |        |
                  | | | |                           |________|
                  | | | | plug 
                  | | | |
                  |_|_|_| (i know it doesn't look like a plug, but it's a plug :-) )
                   || ||
                   || ||&#13;</PRE
></FONT
></TD
></TR
></TABLE
><P
>			To connect the system, just connect your home electrical device to the power outlet. That is it!
			You don't need to make any change on the electrical device. And you can 
			connect any kind of device to that power outlet. Plug this power outlet into any wall outlet.
			</P
><P
>To see photos of what the finished product looks like, go to the following sites:</P
><P
></P
><UL
><LI
><P
><A
HREF="http://edc.sourceforge.net/p1.jpg"
TARGET="_top"
>http://edc.sourceforge.net/p1.jpg</A
></P
></LI
><LI
><P
><A
HREF="http://edc.sourceforge.net/p2.jpg"
TARGET="_top"
>http://edc.sourceforge.net/p2.jpg</A
></P
></LI
><LI
><P
><A
HREF="http://edc.sourceforge.net/p3.jpg"
TARGET="_top"
>http://edc.sourceforge.net/p3.jpg</A
></P
></LI
></UL
><P
>The following URL shows a complete electronic circuit (control 8 devices):
		<A
HREF="http://edc.sourceforge.net/01.png"
TARGET="_top"
>http://edc.sourceforge.net/01.png</A
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="THANKS"
></A
>5. Special Thanks</H1
><P
>Special thanks to Rufus Chang <A
HREF="mailto:rufus@chu.url.com.tw"
TARGET="_top"
>             rufus@chu.url.com.tw</A
>.</P
><P
>Special thanks to Chih-Wei Huang <A
HREF="mailto:cwhuang@linux.org.tw"
TARGET="_top"
>			cwhuang@linux.org.tw</A
>.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="COPYRIGHT"
></A
>6. Copyright and License</H1
><P
>Copyright Rui Li 2000-2001. License is GNU GPL, but it is requested that 
			you retain the author's name and email on all copies. Please keep my name and 
			e-mail address when you are copying this HOWTO.</P
></DIV
></DIV
></BODY
></HTML
>